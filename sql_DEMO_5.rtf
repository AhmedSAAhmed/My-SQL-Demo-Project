 #analyzing channel portfolio
 
select * 
from website_sessions;

Select
    utm_content,
    count(distinct website_sessions.website_sessions_id)  AS sessions
    --orders,
    --cvr
    from  website_sessions\par
    where website_sessions.created_at between '2014-01-01' and '2014--02-01'\par
    group by 1 \par
   orders by sessions desc;\par
\par
Select\par
    utm_content,\par
    count(distinct website_sessions.website_sessions_id)  AS sessions,\par
    count(distinct orders.order_id) AS orders,\par
    --cvr \par
    from  website_sessions\par
    where website_sessions.created_at between '2014-01-01' and '2014--02-01'\par
    group by 1 \par
   orders by sessions desc;\par
\par
Select
    utm_content,
    count(distinct website_sessions.website_sessions_id)  AS sessions,
    count(distinct orders.order_id) AS orders,
    count(distinct orders.order_id) /count(distinct website_sessions.website_sessions_id) AS cvr
    from  website_sessions
    where website_sessions.created_at between '2014-01-01' and '2014--02-01'
    group by 1 \par
   orders by sessions desc;\par
----------------------------------------------------------------------------------------------------------
SELECT\par
  --yearweek(created_at) AS yrwk,\par
  min(date(created_at)) AS week_start_day\par
  count(distinct website_sessions_id) AS total_sessions,\par
  count(distinct case when utm_source = 'gsearch'  THEN website_sessions_id else NULL END) AS gsearch_sessions,\par
count(distinct case when utm_source = 'bsearch'  THEN website_sessions_id else NULL END) AS bsearch_sessions\par
  --bsearch_sessions\par

FROM website_sessions\par
where created_at between '2012-08-22' AND '2012-11-29'\par
  AND utm_campaign = 'nonbrand'\par
group by yearweek(created_at) \par
--------------------------------------------------------------------------------------------------------------
SELECT\par
  utm_source,\par
  count(distinct website_sessions_id) AS sessions,\par
  count(distinct case when device_type = 'mobile_phone' then website_sessions_id ELSE NULL END) AS mobile_sessions,\par
--count(distinct case when device_type = 'mobile_phone' then website_sessions_id ELSE NULL END) /count(distinct website_sessions_id) AS pct_mobile\par
\par
FROM website_sessions
WHERE created_at between '2012-08-22' AND '2012-11-30
   AND utm_campaign = 'non-brand'
group by 1 ;



ï¿½
